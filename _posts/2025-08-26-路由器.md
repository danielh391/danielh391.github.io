---
layout:     post
title:      路由器
subtitle:   
date:       2025-08-26
author:     danielh
header-img: img/post-bg-rwd.jpg
catalog: true
tags:
    - 网络


---

**路由器中路由表的来源**

![](/imgs/2025-08-26/TILEayRxdJN0ynoX.png)

**直连路由器后，会发生什么？**

当你将计算机直连路由器并成功获取到IP地址（通常通过DHCP协议自动获取）后，操作系统内核的网络栈会自动在路由表中添加**三条核心路由条目**。

### 这三条路由规则的具体作用

#### 1. 默认路由 (Default Route)

-   **条目：** `0.0.0.0` + `0.0.0.0` -> `192.168.31.1`
    
-   **作用：** **处理所有发往互联网的流量。** 这是最重要的一条规则。
    
-   **解读：**
    
    -   `Network Destination 0.0.0.0` 和 `Netmask 0.0.0.0` 组合在一起表示“**任何网络地址**”。它是一个通配符，匹配所有目标。
        
    -   这条规则的意思是：**“如果你要发送数据包到任何目标（无论是 `google.com` 还是任何其他公网/私网IP），而前面的更具体规则都不匹配，那么就一律把这个数据包交给网关 `192.168.31.1`（也就是你的路由器），让它去处理。”**
        
    -   它就像是地图上的“**所有其他未知目的地，请上这条高速公路**”的指示牌。
        

#### 2. 本地网络路由 (Local Network Route)

-   **条目：** `192.168.31.0` + `255.255.255.0` -> `On-link`
    
-   **作用：** **处理发往同一局域网内其他设备的流量。**
    
-   **解读：**
    
    -   `Network Destination 192.168.31.0` 不是一个可用的IP地址，它代表的是“**192.168.31.x**”这个**整个网段**。
        
    -   `On-link` 或网关为空表示：“**目标设备就在你自己的本地网络上，不需要经过网关路由器，直接送达即可。**”
        
    -   这条规则的意思是：**“如果你要访问同一个局域网内的设备（比如访问IP为 `192.168.31.200` 的NAS，或者 `192.168.31.1` 的路由器管理界面），请直接发送，不要出门绕一圈。”**
        
    -   计算机会使用**ARP协议**来查询目标IP对应的MAC地址，然后通过交换机（或直接）将数据帧送给对方。这保证了局域网内通信的高速和高效。
        

#### 3. 本地广播路由 (Local Broadcast Route)

-   **条目：** `192.168.31.255` + `255.255.255.255` -> `On-link`
    
-   **作用：** **处理发送给本网络内所有设备的广播流量。**
    
-   **解读：**
    
    -   `192.168.31.255` 是这个子网的**广播地址**。发送到这个地址的数据包，局域网内的所有设备都会接收。
        
    -   `255.255.255.255` 是限制最严格的子网掩码，表示只匹配这一个具体的地址。
        
    -   这条规则确保了广播包（例如DHCP请求、ARP查询等）能在本地网络内正确传播，而不会被发送到网关去互联网上。

### 总结

直连路由器后自动生成的路由表，其核心作用就是**为数据包的出口路径提供决策依据**，实现了流量的智能分流：

路由类型

目标地址

下一跳

作用

类比

**默认路由**

`0.0.0.0` (所有地址)

路由器网关

**访问互联网**

**出国的国际航班**

**本地网络路由**

`192.168.31.0/24` (本地网段)

直接送达 (`On-link`)

**访问局域网内设备**

**市内的公交车**

**广播路由**

`192.168.31.255` (广播地址)

直接送达 (`On-link`)

局域网广播

**对全市的广播**
<!--stackedit_data:
eyJoaXN0b3J5IjpbMTA3NjU5OTAzNiwxMDY4OTYwMjYyLC01ND
Q5MjQzODFdfQ==
-->